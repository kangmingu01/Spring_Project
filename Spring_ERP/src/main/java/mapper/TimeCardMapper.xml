<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="mapper.TimeCardMapper">



    <!-- 타임카드 기본 데이터 조회 -->
    <select id="getTimecardDefaultData" resultType="map">
        SELECT 
            e.name AS employee_name,
            o.org_name AS organization_name,
            e.sicktime,
            e.overtime_hours,
            e.vacation_hours
        FROM employee e
        LEFT JOIN organization o ON e.org_id = o.org_id
        WHERE e.employee_id = #{employeeId}
    </select>

    <!-- 타임카드 데이터 삽입 -->
    <insert id="insertTimecard">
        <selectKey resultType="int" keyProperty="timecardNo" order="BEFORE">
            SELECT SEQ_TIMECARD.NEXTVAL FROM dual
        </selectKey>
        INSERT INTO timecard VALUES (#{timecardNo}, #{employeeId}, #{organizationName}, #{sicktime}, #{overtimeHours}, #{vacationHours}, #{dailywork}, #{workedhours}, SYSDATE)
    </insert>


	
	<update id="updateTimeCard">
		update timecard set dailywork=#{dailywork}, workedhours=#{workedhours} where timecardid=#{timecardid}
	</update>

<select id="selectTimeCardByName" parameterType="String" resultType="TimeCard">
    select t.* from timecard t join erp_user u on t.userid = u.userid where u.name = #{name}
</select>
</mapper>